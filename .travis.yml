language: c

sudo: required

env:
  global:
    # BINTRAY_USER
    - secure: "QWMy89JagJKoBW5mEeHgoSUmbUKtGCaXSb0a6aVHKhXur5Ii01fMXbI8ARcRz6SSGQeAGPTcutJAMLMVne41Ph/E2pwZ9hpfkS+DSbccYfW6aFjWpyOWhR+eNKqWuD+QkmNzaPApFZWdn5tTzoYteuilPwIzEUCjqo9DALv+QlQ="
    # BINTRAY_API_KEY
    - secure: "OofAWG/Dz1DQ6SCr3xys4djiYMgqlf/+PIg5TW9e4usTC8oP+oSE3vKMxOWLQwYYrBs4qaXODKRHXLXxy6wpFUY0cBEAC8n/T/bPQiw/4rkpC/SYbKr6L6/wd1uQsd2DFCVXqOh9DAgfz/hUwvVNZVRUdfBDKTLHQPVj8aI+oUk="
    # BINTRAY_REPO_OWNER
    - secure: "TXxb3Jb7Ir0WTq6cAn6/F/+0keIYSN6JuUG6tedhtw59+GjuAHiBnFAS3p0ljPepky7gaP+xWqa+PUfilEMW9AhwByYwtZJFcAi5ffmtj+njOTu55g+hhnZkfy2G3aclE9gcO7OHLc8FYgQ0Tl5xCfe1B9CbdLbW9xIsty6CqOs="

arch:
  packages:
    - qt5-declarative
    - qt5-wayland
    - extra-cmake-modules
    - libdrm
    - mesa-libgl
    - wayland
    - wayland-protocols
    - libinput
    - libxkbcommon
    - xcb-util-cursor
    - libxcursor
    - xorg-server-xvfb
  script:
    - cmake . -DKDE_INSTALL_USE_QT_SYS_PATHS=ON -DCMAKE_INSTALL_PREFIX=/usr
    - make
    #- sudo make install
    #- xvfb-run -a -s "-screen 0 800x600x24" make test
    - if [ "$CC" = "gcc" -a "$TRAVIS_BRANCH" = "develop" ]; then ./.travis/bintray.sh; fi
    - ./.travis/bintray-wrapper.sh

script:
  - "curl -s https://raw.githubusercontent.com/mikkeloscar/arch-travis/master/arch-travis.sh | bash"

deploy:
  provider: bintray
  on:
    branch: develop
    condition: "$CC = gcc"
  file: cibuild/bintray.json
  user:
    secure: "CNhU95jyaVk/zgKy3D0wdjDUDxKt+lT3AbgC9HOHSyyzN9FjPzK/O7MWnHqpR7W1aeoG5o4PZ+RakRLmW5NZxOKDg/K+mVq1s6cMwwZu8YcaHLafifC3GZI/c+0mnCpJY2K5mWqVp/TSIRkn6RJV7xIJR8Ksds/1BSvCVhLWsTGDxWqzeij1VpptvFU+th1h5vpOhdkqkrDOrLFFvTODt1fRcyU+V6mn/VHzCDSDAmyokmbtEkiRXT1usuZ6wdUyIauOL15MVcHQmqSjuwqBB9Xta6S/cKDfMnQkfQ+Zs9KOH2hf0pkJZKxUl0sQiwRl7aXcaZJhhHQMXEdvNUWiuLz4SHEGqYiAm1rFhoAu+0jzK3uOymKIjvMSwfh1e27wLP+MSYUS510XldoI60aBwtCfef6LhV2Lh3zLILmR/m9551wn9W3m/hLPXStNCSMDsFmJMiv33Wl+2nQudJS44rLXgohSqGQmJxkI5aqwQajej1LqA9FzyrH7dfgym3MtRQYvKynBJxvSqfcFUinjUYL1q8pEXOI6mRRhxpH8+N8Xu9AsKvRDBlgjhKzDF1jsIyJ/qKoiaJHQSrN9uLj3jrt9efR5oT2VcuMldaMpuUY/7b5k6n6CWT5LUryox+hw7XVyc5FZfrHfkPkRx+nUmtG+F6pH7DzaantPnOJI+rA="
  key:
    secure: "hGuLSiuPkgs5/7lspblR353f1Lioe8FOUDiGrvF2mGg9mBok6bSXbVJ+RUadfLQ3olwOM0g8tE/38fCHkdoH2QYFAXKlyJEFOYoM9MeI8ZQ+6uz1v1P4XHrY3GFICN/V7Q6JjImxhQ6NKWwWQgAKuZmKbtfZLZU897ArQW5mQCIMdkcyJLWhkrFCy1/hD5ihmB6DycAaqB0TWK5hGHYGNX3bPNLLlV7DFMuPXLbE8GljpHHlyBqgj2EPK4CpMSaVSC7uo73WKJ7sWyTXPFVU+AD7zXxxNBZ5WIueGR2OB+FyX6jh687//XlJq07bw7vkKj4KxrwtDcMfFIG0hjhFJ2njVIRC93STd/TkoLc6yH4aSLZEIWYjPA+HcCU6XXfGdi/U7kuTNmYlGPq87OwA3pBWEVeEQpbERohKBpTYpPNF9H8PMMQiPsKhNwfzuKLDK7+aM9mxLbrPv1/G6Uatw2lMSlfhHJLnxpcVdP2xJJ/leHPXbRbkPAASvSWTqFjrQxAUK5bzpb/zpourCPw1Rhl2naiyohiYUmJt223x9UYiVh6Y+/TmMc8QL68R/uWVY2bBwTvqvuf8kr0QLeldblETMlmDu4r++HLkv+Cz+3ktO13e9e4oRiSKACRYWnZ+Cosg2Fj5u75cfkUYlumL4QWtanakw82deC75b/b7VS0="

notifications:
  email: false
  slack: lirios:fdUqVmPzqPskEL1UBhqapZ0w
